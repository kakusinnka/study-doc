# 使用 Docker 开发

## 概述
此页面包含适用于希望使用 Docker 构建新应用程序的应用程序开发人员的资源列表。

## 最佳实践
### 如何让你的镜像变小
* 从合适的基础镜像开始。
* 使用多阶段构建。
* 如果您有多个具有很多共同点的图像，请考虑使用共享组件创建您自己的 基础图像，并以此为基础创建您独特的图像。
* 要保持生产映像精简但允许调试，请考虑使用生产映像作为调试映像的基础映像。
* 构建镜像时，始终使用有用的标签来标记它们
### 在哪里以及如何保存应用程序数据
* 避免将应用程序数据存储在容器的可写层中。
* 使用卷存储数据。
* 一种适合使用绑定挂载的情况是在开发期间，当您可能想要挂载源目录或刚刚构建到容器中的二进制文件时。对于生产，请改用卷。
* 对于生产环境，使用 secrets 存储服务使用的敏感应用程序数据，使用 configs 存储配置文件等非敏感数据。
### 使用 CI/CD 进行测试和部署
### 开发环境和生产环境的差异
| 开发环境 | 生产环境 |
| ---- | ---- |
| 使用绑定安装让您的容器可以访问您的源代码。 | 使用卷来存储容器数据。 |
|  使用 Docker Desktop | 使用 Docker 引擎，如果可能的话，使用用户映射来更好地隔离 Docker 进程与主机进程。 |
| 不用担心时间漂移。 | 始终在 Docker 主机上和每个容器进程中运行 NTP 客户端，并将它们全部同步到同一 NTP 服务器。如果您使用 swarm 服务，还要确保每个 Docker 节点将其时钟同步到与容器相同的时间源。 |

## 构建镜像
### 编写 Dockerfile 的最佳实践
编写 Dockerfile 的最佳实践, Docker 通过读取 Dockerfile 中的指令自动构建镜像, 一个文本文件，其中按顺序包含构建给定镜像所需的所有命令。
### 一般准则和建议
* 创建临时容器
* 了解构建上下文
* 通过标准输入代表 Dockerfile
  ```
  echo -e 'FROM busybox\nRUN echo "hello world"' | docker build -
  ```
  ```
  docker build -<<EOF
  FROM busybox
  RUN echo "hello world"
  EOF
  ```
* 使用来自标准输入的 Dockerfile 构建图像，而不发送构建上下文
* 使用来自标准输入的 Dockerfile 从本地上下文构建
* 使用来自标准输入的 Dockerfile 从远程上下文构建
* 使用 .dockerignore 排除
* 使用多阶段构建: 多阶段构建允许您大幅减小最终图像的大小，而无需努力减少中间层和文件的数量。
* 不要安装不必要的包
* 解耦应用程序: 每个容器应该只有一个问题。将每个容器限制为一个进程是一个很好的经验法则，但这不是一个硬性规定。
* 尽量减少层数
* 对多行参数进行排序
* 利用构建缓存
### Dockerfile 说明



## 扫描镜像